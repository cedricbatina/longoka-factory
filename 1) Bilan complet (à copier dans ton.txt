1) Bilan complet (√† copier dans ton journal de dev)

Je te remets le bilan ‚Äúpropre‚Äù (celui qu‚Äôon vient de consolider) :

üóìÔ∏è Bilan ‚Äî Factory DB (6i695q_factory_db) + Le√ßon 9 (Kikongo) ‚Äî 21/12/2025

Contexte & d√©cision d‚Äôarchitecture

Objectif : b√¢tir une ‚ÄúFactory‚Äù de contenus p√©dagogiques (le√ßons ‚Üí r√®gles / chips / atomes / exemples / sources) r√©utilisable pour :
web, mobile, livres, jeux (mots m√™l√©s, mots crois√©s‚Ä¶), scripts InDesign, etc.

On √©vite les ENUM (trop rigides) : tout passe par des tables de r√©f√©rence (types, sous-types, tags, relations‚Ä¶).

Les traductions du lexique (kg‚Üîfr‚Üîen etc.) restent dans Lexikongo/Lexilingala.
Dans la Factory, on ne stocke des traductions que si c‚Äôest utile p√©dagogiquement (exemples, gloses d‚Äôatomes ‚Äúracines‚Äù, notes de r√®gles).

0) Nettoyage DB ‚Äúlongoka_new_db‚Äù (source Longoka)

Probl√®me initial : collision de slug (ex. lesson_id 59 et 60 pointaient vers le m√™me lesson_slug_id=120).

R√©solution : correction des donn√©es pour avoir 1 slug par le√ßon, puis ajout d‚Äôune contrainte :

ALTER TABLE lessons ADD UNIQUE KEY uq_lessons_lesson_slug_id (lesson_slug_id)

V√©rifications : plus aucun doublon lesson_slug_id / slug en sortie de requ√™tes HAVING COUNT(*) > 1.

1) Factory DB ‚Äî Sch√©ma op√©rationnel
Tables ‚Äúcontenu cours‚Äù (pivot = lesson_ref)

lesson_refs : r√©f√©rence externe (platform_id, course_id, lesson_id) + slug/titre/statut/visibilit√©.

chips + chip_types : micro-blocs √©ditoriaux (objectif, r√®gle, note, √† retenir‚Ä¶).

rules + rule_types + lesson_rules : r√®gles r√©utilisables (prosodie, orthographe, p√©dagogie‚Ä¶), reli√©es √† une le√ßon avec un niveau d‚Äôimportance.

examples : exemples (kg_text + fr_text/en_text optionnels + notes_md).

Tables ‚Äúatomes‚Äù (graphemes, syllabes, morph√®mes‚Ä¶)

atoms + atom_types + atom_subtypes : entit√©s atomiques (grapheme, syllable, stem, morpheme, word, etc.).

lesson_atoms + lesson_atom_roles : relie les atomes √† une le√ßon (core / bonus) + evidence.

graphemes + grapheme_kinds + orthographies : inventaire de graph√®mes par orthographe (kg classique).

atom_grapheme_seq : d√©composition atom ‚Üí s√©quence de graph√®mes (orthography_id + seq).

Tra√ßabilit√© / science / bibliographie

sources + source_kinds : bibliographie.

atom_sources : relie un atome √† une source + ref/quote/comment.

tags + atom_tags : tagging extensible (etym_root, source_sungu_banzuzi, theory_*‚Ä¶).

theories : option ‚Äúmod√®les/th√©ories‚Äù (ex. Sungu Banzuzi, Nsaudi‚Ä¶).

Relations

relation_types + atom_relations : liens structurants entre atomes (derived_from, composed_of, has_prefix, has_etym_root, variant_of, etc.).

2) Le√ßon 9 (course_id=3, lesson_id=9) ‚Äî import termin√©
R√©f√©rence le√ßon

lesson_ref_id = 1

slug : lalphabet-du-kikongo-et-la-structure-des-mots-et-des-sons

group : ‚ÄúLa syntaxe‚Äù, statut=published, visibilit√©=public

Volumes (contr√¥l√©s via vues)

v_lessons_overview (lesson_ref_id=1) :

chips : 14

rules : 9

examples : 10

atoms li√©s : 46 (20 core + 26 bonus)

graphemes : 20

syllables : 26

Chips (14) ‚Äî th√®mes

Objectif

Voyelles : groupes

√âpellation (ta/ata)

Prononciation (rappels)

Inventaire (cours)

Tons : diacritiques

Alternative sans diacritiques (double voyelle) ‚Äî valid√©e

Norme Factory

Diphthongues : √©crire ce qu‚Äôon prononce

Transformations euphoniques (nasales & apostrophe)

Pi√®ges fr√©quents

Check-list lecture correcte

Syllabes ouvertes

Check-list lecture (30s)

Rules (9)

Prosodie/tons : diacritiques + r√®gle ‚Äúdouble voyelle (sans diacritiques)‚Äù

P√©dagogie : √©pellation ta/ata

Orthographe : norme Factory (pas de i‚Üíy / u‚Üíw, on √©crit ce qu‚Äôon prononce)

autres r√®gles li√©es (nasales, diphthongues, syllabes ouvertes, etc.)

Alphabet (core) ‚Äî 20 graph√®mes

Voyelles : i u a e o

Semi-voyelles : w y

Consonnes : b d f g k l m n p s t v z

Syllabes-racines (bonus) ‚Äî 26 (CV=14, CCV=12)

CV : ka ki ko li da de di do du pa pe pi po pu

CCV : nda nde ndi ndo ndu mpa mpe mpi mpo mpu ngo ngu

Qualit√© / int√©grit√©

orthographies : 1 ligne ‚ÄúKikongo classique‚Äù, is_default=1

graphemes : 20

atom_grapheme_seq : mapping OK ; check ‚Äús√©quence compl√®te‚Äù retourne 0 anomalie.

lesson_atoms : 20 graphemes (core) + 26 syllables (bonus)

3) Sources & th√©ories (√©tymologie / lettres)

Source ajout√©e :

code = sungu_banzuzi_roots (kind=book)

atom_sources :

26 syllabes li√©es √† cette source (1 lien par syllabe).

tags / th√©ories :

Tagging en place pour ‚Äútheory_sungu_banzuzi‚Äù et ‚Äútheory_nsaudi_letters‚Äù

R√©sultat : 26 syllabes + 20 graph√®mes tagg√©s (utile pour filtrer/afficher par ‚Äúcadre th√©orique‚Äù).

4) Normes linguistiques retenues

Pas d‚Äôexception i‚Üíy / u‚Üíw : √©criture ‚Äúphon√©tique‚Äù stable.

‚ÄúDouble voyelle‚Äù valid√©e comme alternative sans diacritiques (ex. k√¥ka ‚Üí kooka).

Syllabe kikongo : ouverte (consonne(s) + voyelle), pas de consonne finale.

Ex : mpimpa s‚Äô√©crit mpimpa, mais peut se prononcer [mpiimpa] (r√®gle prosodique/allongement).

√Ä stocker comme rule + example (pas besoin d‚Äôinventer une syllabe ‚Äúim‚Äù).

5) √âtat global DB (compteurs)

lesson_refs : 1

chips : 14

rules : 9

examples : 10

atoms : 54

atom_relations : 5

6) Prochaine √©tape recommand√©e (avant Le√ßon 10)
A) Stabiliser le ‚Äúdashboard data‚Äù

Garder les vues existantes :

v_lessons_overview

v_lesson_chips

v_lesson_atoms

(+ id√©alement v_lesson_rules, v_lesson_examples si besoin)

B) Ajouter 2 briques pour l‚Äôusine ‚Äúmulti-produits‚Äù

Export JSON ‚ÄúLesson Pack‚Äù (idempotent)

Donne : lesson_ref + chips + rules + examples + atoms (+ graph√®mes/syllabes d√©compos√©es).

Sert de format d‚Äô√©change pour web/mobile/InDesign/g√©n√©rateurs.

G√©n√©ration d‚Äôexercices (plus tard)

G√©n√©ration partielle depuis inventaire + r√®gles + progression, tout en gardant des exos ‚Äúfaits main‚Äù.

7) Orientation ‚ÄúJava plut√¥t que Nuxt‚Äù

On a d√©j√† un projet Java (backend-java) orient√© g√©n√©ration de jeux depuis Lexikongo/Lexilingala.

Proposition : ajouter un package ‚Äúfactory‚Äù qui lit 6i695q_factory_db et produit :

export JSON des le√ßons

endpoints API (optionnel ensuite)
=> Nuxt devient un client (dashboard), pas la source de v√©rit√©.

Fin.

2) ‚ÄúAllons-y‚Äù = j‚Äôai pr√©par√© le module Java d‚Äôexport Lesson Pack

J‚Äôai int√©gr√© dans ton projet backend-java :

une connexion openFactoryConnection() dans DbConfig

un d√©p√¥t FactoryLessonRepository

un tool CLI : FactoryLessonPackJsonExportTool

des mod√®les LessonPack, Atom, Chip, Rule, Example, etc.

export inclut :

lesson_ref + chips + rules + examples

atoms (core/bonus)

atom_grapheme_seq (d√©composition selon orthographe kg par d√©faut)

atom_tags, atom_sources, atom_glosses

relations (atom_relations) filtr√©es sur les atoms de la le√ßon

üì¶ T√©l√©chargement

Download backend-java_factory-lessons.zip

Utilisation (chez toi)

Tu peux renseigner la connexion factory via env vars (sans toucher aux fichiers properties) :

FACTORY_DB_HOST

FACTORY_DB_PORT (optionnel, d√©faut 3306)

FACTORY_DB_NAME (ex: 6i695q_factory_db)

FACTORY_DB_USER

FACTORY_DB_PASS

Puis lancer (apr√®s build Maven chez toi) :

FactoryLessonPackJsonExportTool --course 3 --lesson 9 --out lesson-3-9.json

3) Point important sur tes ‚Äúrelations compos√©es‚Äù (mpiimpa, etc.)

Tu avais commenc√© un VALUES (..., seq, ...) : attention, ta table atom_relations n‚Äôa pas de colonne seq (PK = from_atom_id, to_atom_id, relation_type_id).

üëâ Deux options propres :

Simple (maintenant) : garder l‚Äôordre dans notes_md (ex: seq=1; analyse=mpi-im-pa)

Propre (plus tard) : ajouter une table d√©di√©e, par ex :

atom_relation_parts(from_atom_id, relation_type_id, seq, to_atom_id, notes_md, ...)

On peut rester sur l‚Äôoption (1) tant qu‚Äôon est en phase ‚Äúfactory lessons‚Äù.